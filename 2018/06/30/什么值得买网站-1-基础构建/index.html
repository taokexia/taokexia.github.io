<!DOCTYPE HTML>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

    

    <title>什么值得买网站-1.基础构建 | </title>
    <meta name="author" content="桃客侠">
    
    <meta name="description" content="项目使用Webpack来搭建Koa.js以及Vue.js的开发环境以及运行环境。
为了学习，本次项目从零开始配置Webpack,而不使用koa-generator或vue-cli
初始化项目
创建smzdm目录
进入目录，使用npm init初始化项目
配置package.json文件

在pack">
    
    
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

    <meta property="og:title" content="什么值得买网站-1.基础构建"/>
    <meta property="og:site_name" content="我的博客"/>

    
    <meta property="og:image" content=""/>
    

    <link rel="icon" type="image/png" href="/favicon.png">
    <link rel="alternate" href="/atom.xml" title="我的博客" type="application/atom+xml">
    <link rel="stylesheet" href="/css/lib/materialize.min.css">
    <link rel="stylesheet" href="/css/lib/font-awesome.min.css">
    <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">

    
        <link rel="stylesheet" href="/css/lib/prettify-tomorrow-night-eighties.css" type="text/css">
    
    <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
</head>


<body>
    <img src="/weixin_favicon.png" style="position: absolute; left: -9999px; opacity: 0; filter: alpha(opacity=0);">

    <nav class="indigo">
    <div class="nav-wrapper">
        <a href="#" data-activates="main-menu" class="button-collapse">
            <i class="fa fa-navicon"></i>
        </a>
        <div class="">
            <a href="/" class="brand-logo hide-on-med-and-down">我的博客</a>
            <ul class="right hide-on-med-and-down">
                
                    <li>
                        <a class="menu-home " href="/" >
                            <i class="fa fa-home "></i>
                            
                            首页
                        </a>
                    </li>
                
                    <li>
                        <a class="menu-archive " href="/archives" >
                            <i class="fa fa-archive "></i>
                            
                            归档
                        </a>
                    </li>
                
                    <li>
                        <a class="menu-category category-menu" href="javascript:;" data-activates="category-menu" >
                            <i class="fa fa-bookmark "></i>
                            
                            分类
                        </a>
                    </li>
                
                    <li>
                        <a class="menu-reading " href="/reading" >
                            <i class="fa fa-book "></i>
                            
                            读书
                        </a>
                    </li>
                
                    <li>
                        <a class="menu-about " href="/about" >
                            <i class="fa fa-user "></i>
                            
                            关于
                        </a>
                    </li>
                
                    <li>
                        <a class="menu-search modal-trigger " href="#search" >
                            <i class="fa fa-search "></i>
                            
                            搜索
                        </a>
                    </li>
                
            </ul>
            <div>
    <ul class="side-nav indigo darken-1" id="main-menu">
        

        
            <li class="no-padding">
                <a class="waves-effect menu-home " href="/" >
                    <i class="fa fa-home "></i>
                    
                    首页
                </a>
            </li>
        
            <li class="no-padding">
                <a class="waves-effect menu-archive " href="/archives" >
                    <i class="fa fa-archive "></i>
                    
                    归档
                </a>
            </li>
        
            <li class="no-padding">
                <a class="waves-effect menu-category category-menu" href="javascript:;" data-activates="category-menu" >
                    <i class="fa fa-bookmark "></i>
                    
                    分类
                </a>
            </li>
        
            <li class="no-padding">
                <a class="waves-effect menu-reading " href="/reading" >
                    <i class="fa fa-book "></i>
                    
                    读书
                </a>
            </li>
        
            <li class="no-padding">
                <a class="waves-effect menu-about " href="/about" >
                    <i class="fa fa-user "></i>
                    
                    关于
                </a>
            </li>
        
            <li class="no-padding">
                <a class="waves-effect menu-search modal-trigger " href="#search" >
                    <i class="fa fa-search "></i>
                    
                    搜索
                </a>
            </li>
        
    </ul>

    <ul class="side-nav indigo darken-1" id="category-menu">
    

            

            <li class="collapse-level-0" collapse-level="0">
                <a class="no-padding" href="/categories/Vue实战/">
                    Vue实战 <span class="right">1 篇</span></a>
                </a>
            </li>

        

    </ul>
</div>

        </div>
    </div>
</nav>

<div id="search" class="modal search-modal">
    <div class="row">
        <div class="input-field col s12">
              <input id="search-input" type="text">
              <label for="search-input">搜索</label>
        </div>

    </div>
    <div id="search-result" class="search-result col s12">

    </div>
</div>


    <main>
        <div class="container main-container">
    <nav class="page-nav hide-on-small-only">
    <div class="nav-wrapper indigo">
        <span class="breadcrumb">当前位置（分类目录）</span>
        
            
    
    
    <a class="breadcrumb" href="/categories/Vue实战/">Vue实战</a>


        

        
    </div>
</nav>

<article>
    <div class="card">
        <div class="card-content">
            

            <div class="article-title">
                
    
        <h1>什么值得买网站-1.基础构建</h1>
    


            </div>
            <time class="pink-link-context" datetime="2018-06-30T00:06:49.000Z"><a href="/2018/06/30/什么值得买网站-1-基础构建/">2018-06-30</a></time>

            <span id="busuanzi_container_page_pv" class="read-times-container">
    <i class="fa fa-eye"></i>
    <span id="busuanzi_value_page_pv"></span>
</span>

            
    <div class="tags-row">
        
            <a href="/tags/Javascript-VueJS/" class="chip pink lighten-1">Javascript, VueJS</a>
        
    </div>


            <div class="toc pink-link-context hide-on-med-and-down">
    <ol class="section table-of-contents"><li class="section table-of-contents-item section table-of-contents-level-1"><a class="section table-of-contents-link" href="#初始化项目"><span class="section table-of-contents-text">初始化项目</span></a></li><li class="section table-of-contents-item section table-of-contents-level-1"><a class="section table-of-contents-link" href="#编写应用代码"><span class="section table-of-contents-text">编写应用代码</span></a><ol class="section table-of-contents-child"><li class="section table-of-contents-item section table-of-contents-level-2"><a class="section table-of-contents-link" href="#编写Vue代码"><span class="section table-of-contents-text">编写Vue代码</span></a></li></ol></li><li class="section table-of-contents-item section table-of-contents-level-1"><a class="section table-of-contents-link" href="#编写配置文件"><span class="section table-of-contents-text">编写配置文件</span></a><ol class="section table-of-contents-child"><li class="section table-of-contents-item section table-of-contents-level-2"><a class="section table-of-contents-link" href="#babel-配置文件"><span class="section table-of-contents-text">babel 配置文件</span></a></li><li class="section table-of-contents-item section table-of-contents-level-2"><a class="section table-of-contents-link" href="#webpack-配置文件"><span class="section table-of-contents-text">webpack 配置文件</span></a></li><li class="section table-of-contents-item section table-of-contents-level-2"><a class="section table-of-contents-link" href="#postcss-配置文件"><span class="section table-of-contents-text">postcss 配置文件</span></a></li></ol></li><li class="section table-of-contents-item section table-of-contents-level-1"><a class="section table-of-contents-link" href="#编译执行"><span class="section table-of-contents-text">编译执行</span></a></li><li class="section table-of-contents-item section table-of-contents-level-1"><a class="section table-of-contents-link" href="#Koa基础功能"><span class="section table-of-contents-text">Koa基础功能</span></a><ol class="section table-of-contents-child"><li class="section table-of-contents-item section table-of-contents-level-2"><a class="section table-of-contents-link" href="#连接数据库"><span class="section table-of-contents-text">连接数据库</span></a></li><li class="section table-of-contents-item section table-of-contents-level-2"><a class="section table-of-contents-link" href="#设置-session-和-bodyparser"><span class="section table-of-contents-text">设置 session 和 bodyparser</span></a></li><li class="section table-of-contents-item section table-of-contents-level-2"><a class="section table-of-contents-link" href="#创建静态文件服务"><span class="section table-of-contents-text">创建静态文件服务</span></a></li><li class="section table-of-contents-item section table-of-contents-level-2"><a class="section table-of-contents-link" href="#配置路由"><span class="section table-of-contents-text">配置路由</span></a></li></ol></li><li class="section table-of-contents-item section table-of-contents-level-1"><a class="section table-of-contents-link" href="#构建-Vue-应用"><span class="section table-of-contents-text">构建 Vue 应用</span></a><ol class="section table-of-contents-child"><li class="section table-of-contents-item section table-of-contents-level-2"><a class="section table-of-contents-link" href="#配置-Vue-路由"><span class="section table-of-contents-text">配置 Vue 路由</span></a></li><li class="section table-of-contents-item section table-of-contents-level-2"><a class="section table-of-contents-link" href="#编写-Vue-组件"><span class="section table-of-contents-text">编写 Vue 组件</span></a></li></ol></li><li class="section table-of-contents-item section table-of-contents-level-1"><a class="section table-of-contents-link" href="#编译运行"><span class="section table-of-contents-text">编译运行</span></a></li></ol>
</div>


            <div class="entry pink-link-context">
                <p>项目使用Webpack来搭建Koa.js以及Vue.js的开发环境以及运行环境。</p>
<p>为了学习，本次项目从零开始配置Webpack,而不使用koa-generator或vue-cli</p>
<h1 id="初始化项目"><a href="#初始化项目" class="headerlink" title="初始化项目"></a>初始化项目</h1><ul>
<li>创建<code>smzdm</code>目录</li>
<li>进入目录，使用<code>npm init</code>初始化项目</li>
<li>配置<code>package.json</code>文件</li>
</ul>
<p>在<code>package.json</code>文件里添加属性代码:\<br>项目在生产环境中依赖的包:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&quot;dependencies&quot;: &#123;</span><br><span class="line">  &quot;axios&quot;: &quot;^0.16.2&quot;,</span><br><span class="line">  &quot;babel-polyfill&quot;: &quot;^6.23.0&quot;,</span><br><span class="line">  &quot;element-ui&quot;: &quot;^1.4.0&quot;,</span><br><span class="line">  &quot;koa&quot;: &quot;^2.3.0&quot;,</span><br><span class="line">  &quot;koa-bodyparser&quot;: &quot;^4.2.0&quot;,</span><br><span class="line">  &quot;koa-router&quot;: &quot;^7.2.1&quot;,</span><br><span class="line">  &quot;koa-session&quot;: &quot;^5.4.0&quot;,</span><br><span class="line">  &quot;koa-static&quot;: &quot;^4.0.1&quot;,</span><br><span class="line">  &quot;lodash&quot;: &quot;^4.17.4&quot;,</span><br><span class="line">  &quot;marked&quot;: &quot;^0.3.6&quot;,</span><br><span class="line">  &quot;moment&quot;: &quot;^2.18.1&quot;,</span><br><span class="line">  &quot;mongoose&quot;: &quot;^4.11.3&quot;,</span><br><span class="line">  &quot;mongoose-paginate&quot;: &quot;^5.0.3&quot;,</span><br><span class="line">  &quot;vue&quot;: &quot;^2.4.2&quot;,</span><br><span class="line">  &quot;vue-head&quot;: &quot;^2.0.11&quot;,</span><br><span class="line">  &quot;vue-router&quot;: &quot;^2.7.0&quot;,</span><br><span class="line">  &quot;vuex&quot;: &quot;^2.3.1&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>项目在开发和测试环境中依赖的包：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&quot;devDependencies&quot;: &#123;</span><br><span class="line">  &quot;babel-core&quot;: &quot;^6.25.0&quot;,</span><br><span class="line">  &quot;babel-loader&quot;: &quot;^7.1.1&quot;,</span><br><span class="line">  &quot;babel-plugin-syntax-dynamic-import&quot;: &quot;^6.18.0&quot;,</span><br><span class="line">  &quot;babel-preset-env&quot;: &quot;^1.6.0&quot;,</span><br><span class="line">  &quot;babel-preset-stage-3&quot;: &quot;^6.24.1&quot;,</span><br><span class="line">  &quot;cross-env&quot;: &quot;^5.0.5&quot;,</span><br><span class="line">  &quot;css-loader&quot;: &quot;^0.28.4&quot;,</span><br><span class="line">  &quot;cssnano&quot;: &quot;^3.10.0&quot;,</span><br><span class="line">  &quot;extract-text-webpack-plugin&quot;: &quot;^3.0.0&quot;,</span><br><span class="line">  &quot;file-loader&quot;: &quot;^0.11.2&quot;,</span><br><span class="line">  &quot;postcss-cssnext&quot;: &quot;^3.0.2&quot;,</span><br><span class="line">  &quot;postcss-import&quot;: &quot;^10.0.0&quot;,</span><br><span class="line">  &quot;postcss-loader&quot;: &quot;^2.0.6&quot;,</span><br><span class="line">  &quot;postcss-scss&quot;: &quot;^1.0.2&quot;,</span><br><span class="line">  &quot;style-loader&quot;: &quot;^0.18.2&quot;,</span><br><span class="line">  &quot;vue-loader&quot;: &quot;^13.0.2&quot;,</span><br><span class="line">  &quot;vue-template-compiler&quot;: &quot;^2.4.2&quot;,</span><br><span class="line">  &quot;webpack&quot;: &quot;^3.2.0&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>最后，声明一系列npm脚本指令：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&quot;scripts&quot;: &#123;</span><br><span class="line">  &quot;build:server&quot;: &quot;webpack --progress --config webpack.server.config.js&quot;,</span><br><span class="line">  &quot;build:dev&quot;: &quot;cross-env NODE_ENV=development webpack --progress&quot;,</span><br><span class="line">  &quot;build:prod&quot;: &quot;cross-env NODE_ENV=production webpack --progress --hide-modules&quot;,</span><br><span class="line">  &quot;build&quot;: &quot;npm run build:server &amp;&amp; npm run build:prod&quot;,</span><br><span class="line">  &quot;start&quot;: &quot;node dist/app.js&quot;,</span><br><span class="line">  &quot;test&quot;: &quot;echo \&quot;Error: no test specified\&quot; &amp;&amp; exit 1&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>创建<code>src</code>,<code>static</code>,<code>views</code>目录分别存放源代码、静态文件、<code>Koa.js</code>的模板文件</li>
<li>在src目录中创建<code>client</code>和<code>server</code>文件夹</li>
<li><code>npm install</code>安装依赖包</li>
</ul>
<h1 id="编写应用代码"><a href="#编写应用代码" class="headerlink" title="编写应用代码"></a>编写应用代码</h1><p>在<code>server</code>目录中创建<code>app.js</code>文件，输入代码:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">import fs from &apos;fs&apos;</span><br><span class="line">import &#123; resolve &#125; from &apos;path&apos;</span><br><span class="line">import Koa from &apos;koa&apos;</span><br><span class="line">import serve from &apos;koa-static&apos;</span><br><span class="line">//创建Koa应用</span><br><span class="line">const app = new Koa()</span><br><span class="line"></span><br><span class="line">// 使用 koa-static 中间件对 static 目录中的文件提供http静态服务</span><br><span class="line">app.use(serve(resolve(__dirname, &apos;../static&apos;)))</span><br><span class="line">//定义一个中间件读取 views 文件夹下的 index.html 文件,返回读取内容给浏览器</span><br><span class="line">app.use(async (ctx, next) =&gt; &#123;</span><br><span class="line">    const template = fs.readFileSync(resolve(__dirname, &apos;../views/index.html&apos;), &apos;utf-8&apos;)</span><br><span class="line">    ctx.body = template</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">app.listen(3000, () =&gt; console.log(&apos;Server is running at http://localhost:3000&apos;))</span><br></pre></td></tr></table></figure>
<p>在 <code>views</code> 目录中创建 <code>index.html</code>文件，输入代码:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">    &lt;head&gt;</span><br><span class="line">        &lt;meta charset=&quot;utf-8&quot;&gt;</span><br><span class="line">        &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;IE=edge&quot;&gt;</span><br><span class="line">        &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1&quot;&gt;</span><br><span class="line">        &lt;title&gt;什么都值得买&lt;/title&gt;</span><br><span class="line">        &lt;!-- 引入Boostrap的css --&gt;</span><br><span class="line">        &lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css&quot;&gt;</span><br><span class="line">        &lt;link rel=&quot;stylesheet&quot; href=&quot;http://cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap.min.css&quot;&gt;</span><br><span class="line">        &lt;!-- dist文件是webpack编译js后生成的文件 --&gt;</span><br><span class="line">        &lt;link rel=&quot;stylesheet&quot; href=&quot;/dist/styles.css&quot;&gt;</span><br><span class="line"></span><br><span class="line">        &lt;!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries --&gt;</span><br><span class="line">        &lt;!-- WARNING: Respond.js doesn&apos;t work if you view the page via file:// --&gt;</span><br><span class="line">        &lt;!--[if lt IE 9]&gt;</span><br><span class="line">        &lt;script src=&quot;https://cdn.bootcss.com/html5shiv/3.7.3/html5shiv.min.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">        &lt;script src=&quot;https://cdn.bootcss.com/respond.js/1.4.2/respond.min.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">        &lt;![endif]--&gt;</span><br><span class="line">    &lt;/head&gt;</span><br><span class="line"></span><br><span class="line">    &lt;body&gt;</span><br><span class="line">        &lt;div id=&quot;app&quot;&gt;&lt;/div&gt;</span><br><span class="line">        &lt;script src=&quot;/dist/manifest.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">        &lt;script src=&quot;/dist/vendor.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">        &lt;script src=&quot;/dist/app.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">    &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<h2 id="编写Vue代码"><a href="#编写Vue代码" class="headerlink" title="编写Vue代码"></a>编写Vue代码</h2><p>在<code>client</code>目录下创建<code>components</code>目录下,在<code>components</code>创建<code>app.vue</code>文件，构建简单的组件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;hello shiyanlou&lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">div &#123;</span><br><span class="line">  color: #f66;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>
<p>在<code>client</code>目录中创建<code>app.js</code>文件，渲染<code>app.vue</code>到<code>#app</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">import Vue from &apos;vue&apos;</span><br><span class="line">import App from &apos;./components/app.vue&apos;</span><br><span class="line"></span><br><span class="line">//创建 vue 实例,并渲染组件</span><br><span class="line">const app = new Vue(&#123;</span><br><span class="line">    el: &apos;#app&apos;,</span><br><span class="line">    render: h =&gt; h(App)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h1 id="编写配置文件"><a href="#编写配置文件" class="headerlink" title="编写配置文件"></a>编写配置文件</h1><h2 id="babel-配置文件"><a href="#babel-配置文件" class="headerlink" title="babel 配置文件"></a>babel 配置文件</h2><p>Babel的作用是把ES6/ES7语法的代码转换为ES5语法的代码，用于适配低版本的浏览器。<br>在项目目录创建<code>.babelrc</code>文件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;presets&quot;: [</span><br><span class="line">        &quot;env&quot;,</span><br><span class="line">        &quot;stage-3&quot; //用于转换一些ES7语法</span><br><span class="line">    ],</span><br><span class="line">    &quot;plugins&quot;: [</span><br><span class="line">        &quot;syntax-dynamic-import&quot;//插件则是用于解析 import() 函数</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="webpack-配置文件"><a href="#webpack-配置文件" class="headerlink" title="webpack 配置文件"></a>webpack 配置文件</h2><p>Webpack用于打包js,css,图片以及字体等常用文件。<br>编写服务端配置文件<code>webpack.server.config.js</code>：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">const path = require(&apos;path&apos;)</span><br><span class="line">const webpack = require(&apos;webpack&apos;)</span><br><span class="line"></span><br><span class="line">module.exports = &#123;</span><br><span class="line">    //用于指定目标代码的形式,这里会把代码编译成node.js形式</span><br><span class="line">    target: &apos;node&apos;,</span><br><span class="line">    node: &#123;</span><br><span class="line">        __dirname: false</span><br><span class="line">    &#125;,</span><br><span class="line">    //用于指定打包入口</span><br><span class="line">    entry: &#123; </span><br><span class="line">        app: &apos;./src/server/app.js&apos;</span><br><span class="line">    &#125;,</span><br><span class="line">    //用于指定打包入口,指定文件命名方式和文件存放地址</span><br><span class="line">    output: &#123;</span><br><span class="line">        pth: path.resolve(__dirname, &apos;dist&apos;),</span><br><span class="line">        filename: &apos;[name].js&apos;</span><br><span class="line">    &#125;,</span><br><span class="line">    module: &#123;</span><br><span class="line">        rules: [&#123;</span><br><span class="line">            test: /\.js$/,</span><br><span class="line">            exclude: /node_modules/,</span><br><span class="line">            use: &#123;</span><br><span class="line">                // loader用于对模块的源代码进行转换。</span><br><span class="line">                loader: &apos;babel-loader&apos;,//进行js语法转换</span><br><span class="line">                options: &#123;</span><br><span class="line">                    babelrc: false, //示不使用 .babelrc 配置文件的配置项</span><br><span class="line">                    present: [</span><br><span class="line">                        [&apos;env&apos;, &#123;</span><br><span class="line">                            target: &#123;</span><br><span class="line">                                node: &apos;current&apos;</span><br><span class="line">                            &#125;,//打包的目标 Node.js 版本为当前运行的 Node.js 版本</span><br><span class="line">                        &#125;],</span><br><span class="line">                        &apos;stage-3&apos;</span><br><span class="line">                    ]</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>编写前端代码配置<code>webpack.config.js</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line">const path = require(&apos;path&apos;)</span><br><span class="line">const webpack = require(&apos;webpack&apos;)</span><br><span class="line">const ExtractTextPlugin = require(&apos;extract-text-webpack-plugin&apos;)</span><br><span class="line"></span><br><span class="line">module.exports = &#123;</span><br><span class="line">    watch: true,</span><br><span class="line">    entry: &#123; //entry设置两个入口</span><br><span class="line">        app: &apos;./src/client/app.js&apos;,</span><br><span class="line">        vendor: [&apos;vue&apos;, &apos;vue-router&apos;, &apos;vuex&apos;, &apos;axios&apos;] //把数组中的包打包到vendor.js中</span><br><span class="line">    &#125;,</span><br><span class="line">    output: &#123;</span><br><span class="line">        path: path.resolve(__dirname, &apos;static/dist&apos;),</span><br><span class="line">        publicPath: &apos;/dist/&apos;, //设置，打包生成文件的访问地址</span><br><span class="line">        filename: &apos;[name].js&apos;</span><br><span class="line">    &#125;,</span><br><span class="line">    module: &#123;</span><br><span class="line">        rules: [&#123;</span><br><span class="line">            test: /\.vue$/,</span><br><span class="line">            loader: &apos;vue-loader&apos;,</span><br><span class="line">            options: &#123;</span><br><span class="line">                //配合 extract-text-webpack-plugin 提取出 CSS 代码并打包到一个 CSS 文件中</span><br><span class="line">                extractCSS: true </span><br><span class="line">            &#125;</span><br><span class="line">        &#125;, &#123;</span><br><span class="line">            test: /\.js$/,</span><br><span class="line">            loader: &apos;babel-loader&apos;,</span><br><span class="line">            exclude: /node_modules/</span><br><span class="line">        &#125;, &#123;</span><br><span class="line">            test: /\.css$/,</span><br><span class="line">            use: [</span><br><span class="line">                &apos;style-loader&apos;,</span><br><span class="line">                &#123; loader: &apos;css-loader&apos;, options: &#123; importLoaders: 1 &#125; &#125;,</span><br><span class="line">                &apos;postcss-loader&apos;</span><br><span class="line">            ]</span><br><span class="line">        &#125;, &#123;</span><br><span class="line">            test: /\.(png|jpg|gif|svg)$/,</span><br><span class="line">            loader: &apos;file-loader&apos;,</span><br><span class="line">            options: &#123;</span><br><span class="line">                name: &apos;[name].[ext]?[hash]&apos;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;, &#123;</span><br><span class="line">            test: /\.(eot|svg|ttf|woff|woff2)(\?\S*)?$/,</span><br><span class="line">            loader: &apos;file-loader&apos;</span><br><span class="line">        &#125;]</span><br><span class="line">    &#125;,</span><br><span class="line">    resolve: &#123;</span><br><span class="line">        alias: &#123;</span><br><span class="line">            &apos;vue$&apos;: &apos;vue/dist/vue.esm.js&apos; //是打包 vue 模板文件必须配置的项。</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    devtool: &apos;#eval-source-map&apos;,</span><br><span class="line">    plugins: [ //插件</span><br><span class="line">        new ExtractTextPlugin(&apos;styles.css&apos;), //用于指定 CSS 文件名称</span><br><span class="line">        new webpack.optimize.CommonsChunkPlugin(&#123; //用于提取公共包</span><br><span class="line">            names: [&apos;common&apos;, &apos;vendor&apos;, &apos;manifest&apos;],</span><br><span class="line">            minChunks: 2</span><br><span class="line">        &#125;)</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">if (process.env.NODE_ENV === &apos;production&apos;) &#123;</span><br><span class="line">    module.exports.watch = false</span><br><span class="line">    module.exports.devtool = &apos;#source-map&apos;</span><br><span class="line">    module.exports.plugins = (module.exports.plugins || []).concat([</span><br><span class="line">        new webpack.DefinePlugin(&#123;</span><br><span class="line">            &apos;process.env&apos;: &#123;</span><br><span class="line">                NODE_ENV: JSON.stringify(&apos;production&apos;)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;),</span><br><span class="line">        new webpack.optimize.UglifyJsPlugin(&#123;      //用于压缩 js</span><br><span class="line">            sourceMap: true,</span><br><span class="line">            compress: &#123;</span><br><span class="line">                warnings: false</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;),</span><br><span class="line">        new webpack.LoaderOptionsPlugin(&#123;</span><br><span class="line">            // 为 loaders 和插件设置全局 options</span><br><span class="line">            minimize: true</span><br><span class="line">        &#125;)</span><br><span class="line">    ])</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="postcss-配置文件"><a href="#postcss-配置文件" class="headerlink" title="postcss 配置文件"></a>postcss 配置文件</h2><p>在 webpack 中我们配置了 postcss 来处理 css<br>在根目录创建<code>postcss.config.js</code>文件，输入:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">module.exports = &#123;</span><br><span class="line">    syntax: &apos;postcss-scss&apos;,//用于转换 mixins 和变量</span><br><span class="line">    map: false,</span><br><span class="line">    plugins: &#123;</span><br><span class="line">        &apos;postcss-import&apos;: &#123;&#125;, // 用于解析 @import</span><br><span class="line">        &apos;postcss-cssnext&apos;: &#123;&#125;, //包含很多 CSS 新语法</span><br><span class="line">        &apos;cssnano&apos;: &#123;</span><br><span class="line">            zindex: false //压缩 CSS 代码</span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="编译执行"><a href="#编译执行" class="headerlink" title="编译执行"></a>编译执行</h1><p>在 <code>package.json</code> 中 <code>script</code>项中定义的命令，执行命令：</p>
<ul>
<li><code>npm run build</code></li>
<li><code>npm start</code></li>
</ul>
<p>打开浏览器，访问：<code>http://localhost:3000</code></p>
<p>显示结果:<br><img src="https://note.youdao.com/yws/public/resource/1846205add14351700747a3032894a3c/xmlnote/29AE315EEC9F4744AE551F82257A29E0/9918" alt="显示结果"></p>
<p>目录结构:</p>
<p><img src="https://note.youdao.com/yws/public/resource/1846205add14351700747a3032894a3c/xmlnote/5EA0403035694DD7980C175C98AE2EF5/9917" alt="目录结构"></p>
<h1 id="Koa基础功能"><a href="#Koa基础功能" class="headerlink" title="Koa基础功能"></a>Koa基础功能</h1><h2 id="连接数据库"><a href="#连接数据库" class="headerlink" title="连接数据库"></a>连接数据库</h2><p>项目采用的是MongoDB数据库，使用 mongoose 来连接 MongoDB 以及创建 model。</p>
<ul>
<li>安装Mongodb</li>
<li>启动Mongodb服务 <code>sudo service mongodb start</code></li>
<li>编写<code>src/server/app.js</code>代码，连接数据库</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">import Koa from &apos;koa&apos;</span><br><span class="line">import mongoose from &apos;mongoose&apos;</span><br><span class="line"></span><br><span class="line">// 在 mongoose 中使用 Node.js 原生 Promise</span><br><span class="line">// 因为 mongoose 内置 Promise 已不推荐使用</span><br><span class="line">mongoose.Promise = global.Promise</span><br><span class="line">// 连接数据库</span><br><span class="line">mongoose.connect(&apos;mongodb://localhost:27017/smzdm&apos;, &#123;</span><br><span class="line">    useMongoClient: true</span><br><span class="line">&#125;)</span><br><span class="line">// 绑定 error 事件</span><br><span class="line">mongoose.connection.on(&apos;error&apos;, console.error.bind(console, &apos;connect mongodb failed&apos;))</span><br><span class="line">const app = new Koa()</span><br><span class="line">app.listen(3000)</span><br></pre></td></tr></table></figure>
<ul>
<li>编译后运行，没有报错说明已经连接成功。</li>
</ul>
<h2 id="设置-session-和-bodyparser"><a href="#设置-session-和-bodyparser" class="headerlink" title="设置 session 和 bodyparser"></a>设置 session 和 bodyparser</h2><p>通过<code>koa-session</code>来获取 cookie,session  <code>koa-bodyparser</code> 用于给 request 添加 body 。<br>在<code>server/app.js</code>中添加代码:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">// 引入文件</span><br><span class="line">import Koa from &apos;koa&apos;</span><br><span class="line">import session from &apos;koa-session&apos;</span><br><span class="line">import bodyparser from &apos;koa-bodyparser&apos;</span><br><span class="line">import mongoose from &apos;mongoose&apos;</span><br><span class="line">app.keys = [&apos;secretkkk&apos;]</span><br><span class="line">app.use(session(&#123;</span><br><span class="line">    key: &apos;smzdm:sess&apos;, // cookie 的名称</span><br><span class="line">    maxAGE: 86400000, // session 有效期，单位为毫秒</span><br><span class="line">    overwrite: true, // 是否覆盖已存在的同名 session，为 true 表示覆盖</span><br><span class="line">    httpOnly: true, //是否只能通过 http 获取</span><br><span class="line">    signed: true, // 是否创建签名</span><br><span class="line">    rolling: false, // 若为 true 会强制在每次请求中都为 session 设置标识符 cookie， session 有效期也会重置</span><br><span class="line">&#125;, app))</span><br><span class="line">app.use(bodyparser()) // 使用 bodyparser，解析请求中的 body，比如获取通过 post 传送的数据</span><br><span class="line"></span><br><span class="line">app.listen(3000, () =&gt; console.log(&apos;Server is running at http://localhost:3000&apos;))</span><br></pre></td></tr></table></figure>
<h2 id="创建静态文件服务"><a href="#创建静态文件服务" class="headerlink" title="创建静态文件服务"></a>创建静态文件服务</h2><p>还是使用 <code>koa-static</code> 中间件来实现功能，在<code>server/app.js</code>中的代码为”</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">app.use(serve(resolve(__dirname, &apos;../static&apos;)))</span><br></pre></td></tr></table></figure>
<p>编译后可以访问 <code>static</code> 文件夹下的文件</p>
<h2 id="配置路由"><a href="#配置路由" class="headerlink" title="配置路由"></a>配置路由</h2><p>使用 <code>koa-router</code> 创建路由,在 <code>src/server</code>中创建<code>routes</code>文件夹，文件夹下创建<code>index.js</code>文件，添加代码:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">import &#123; resolve &#125; from &apos;path&apos;</span><br><span class="line">import fs from &apos;fs&apos;</span><br><span class="line">import Router from &apos;koa-router&apos;</span><br><span class="line"></span><br><span class="line">export default function(app) &#123;</span><br><span class="line">    const router = new Router()</span><br><span class="line"></span><br><span class="line">    // 所有路由都渲染到此模板</span><br><span class="line">    // 以便把路由交给 Vue 管理</span><br><span class="line">    router.get(&apos;*&apos;, async (ctx, next) =&gt; &#123;</span><br><span class="line">        const template = fs.readFileSync(resolve(__dirname, &apos;../views/index.html&apos;), &apos;utf-8&apos;);</span><br><span class="line">        ctx.body = template;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    app.use(router.routes())</span><br><span class="line">      .use(router.allowedMethods())</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>之后，在<code>server/app.js</code>中添加路由代码:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">import routes from &apos;./routes&apos;</span><br><span class="line">// ...</span><br><span class="line">routes(app)</span><br></pre></td></tr></table></figure>
<p>实现路由交给 Vue 管理的功能。</p>
<h1 id="构建-Vue-应用"><a href="#构建-Vue-应用" class="headerlink" title="构建 Vue 应用"></a>构建 Vue 应用</h1><h2 id="配置-Vue-路由"><a href="#配置-Vue-路由" class="headerlink" title="配置 Vue 路由"></a>配置 Vue 路由</h2><p>首先要配置 Vue 路由，在 <code>src/client</code> 中创建 <code>router</code> 文件夹，文件夹下创建文件 <code>index.js</code>,<br>添加路由代码:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">import Vue from &apos;vue&apos;</span><br><span class="line">import VueRouter from &apos;vue-router&apos;</span><br><span class="line"></span><br><span class="line">// 获取组件,webpack会按需加载js代码，提高单页应用性能。</span><br><span class="line">const home = () =&gt; import(&apos;../pages/home.vue&apos;)</span><br><span class="line">const notFound = ()=&gt; import(&apos;../pages/notFound.vue&apos;)</span><br><span class="line"></span><br><span class="line">Vue.use(VueRouter)</span><br><span class="line"></span><br><span class="line">const router = new VueRouter(&#123;</span><br><span class="line">    mode: &apos;history&apos;, // 配置使用history模式，使得URL和普通URL一样</span><br><span class="line">    linkActiveClass: &apos;active&apos;,// 指定当前路由与 &lt;router-link&gt; 匹配时给其添加 class 值</span><br><span class="line">    routes: [</span><br><span class="line">        &#123;</span><br><span class="line">            path: &apos;/&apos;,</span><br><span class="line">            component: home</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            path: &apos;*&apos;,</span><br><span class="line">            component: notFound</span><br><span class="line">        &#125;</span><br><span class="line">    ],</span><br><span class="line">    scrollBehavior(to, from, savedPosition) &#123;// 用于控制页面滚动</span><br><span class="line">        if (savedPosition) &#123;</span><br><span class="line">            return savedPosition</span><br><span class="line">        &#125;</span><br><span class="line">        return &#123;x: 0, y: 0&#125; // 每次切换路由后，把页面滚动到最顶端</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">export default router</span><br></pre></td></tr></table></figure>
<p>之后修改 <code>client/app.js</code> 文件，引入路由</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">import &apos;babel-polyfill&apos;// 用于实现浏览器不支持原生功能的代码</span><br><span class="line">import Vue from &apos;vue&apos;</span><br><span class="line">// VueHead 组件用于设置每个路由页面的title</span><br><span class="line">import VueHead from &apos;vue-head&apos; </span><br><span class="line"></span><br><span class="line">// 获取组件</span><br><span class="line">import App from &apos;./components/app.vue&apos;</span><br><span class="line">// 引入 router</span><br><span class="line">import router from &apos;./router&apos;</span><br><span class="line"></span><br><span class="line">Vue.use(VueHead)</span><br><span class="line"></span><br><span class="line">// 创建 vue 实例,并渲染组件</span><br><span class="line">const app = new Vue(&#123;</span><br><span class="line">    el: &apos;#app&apos;,</span><br><span class="line">    router, // 传入 router 给 Vue app</span><br><span class="line">    render: h =&gt; h(App)</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h2 id="编写-Vue-组件"><a href="#编写-Vue-组件" class="headerlink" title="编写 Vue 组件"></a>编写 Vue 组件</h2><p>修改 <code>client/components/app.vue</code> 代码,引入组件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;router-view&gt;&lt;/router-view&gt; &lt;!-- 用于挂载各个路由引入组件 --&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style&gt;</span><br><span class="line">body &#123;</span><br><span class="line">    font-family: &apos;Microsoft Yahei&apos;;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>
<p>之后，为了配对路由，在 <code>client</code> 文件夹下创建 <code>pages</code> 文件夹，添加文件 <code>home.vue</code> 和 <code>notFound.vue</code> ,分别实现代码:<br>home.vue内:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;layout-component&gt;</span><br><span class="line">        &lt;div slot=&quot;body&quot;&gt;&lt;!-- 通过指定body插入内容 --&gt;</span><br><span class="line">            home</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">    &lt;/layout-component&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import layout from &apos;../components/layout.vue&apos;</span><br><span class="line">export default &#123;</span><br><span class="line">    components: &#123;</span><br><span class="line">        &apos;layout-component&apos;: layout,</span><br><span class="line">    &#125;,</span><br><span class="line">    head: &#123; //用于VueHead组件</span><br><span class="line">        title: &#123;</span><br><span class="line">            inner: &apos;首页&apos;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure></p>
<p>notFound.vue内:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;layout-component&gt;</span><br><span class="line">        &lt;div slot=&quot;body&quot;&gt;page not found&lt;/div&gt;</span><br><span class="line">    &lt;/layout-component&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import layout from &apos;../components/layout.vue&apos;</span><br><span class="line">export default &#123;</span><br><span class="line">    data() &#123;</span><br><span class="line">        return &#123;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    head: &#123;</span><br><span class="line">        title: &#123;</span><br><span class="line">            inner: &apos;页面不存在&apos;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<p>上面的两个页面都引入了 <code>layout.vue</code> 组件，在 <code>components</code> 目录下实现这个组件:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;div class=&quot;layout&quot;&gt;</span><br><span class="line">        &lt;header-component&gt;&lt;/header-component&gt;</span><br><span class="line">        &lt;nav-component&gt;&lt;/nav-component&gt;</span><br><span class="line">        &lt;div class=&quot;container&quot;&gt;</span><br><span class="line">            &lt;div class=&quot;row&quot;&gt;</span><br><span class="line">                &lt;div class=&quot;col-sm-9&quot;&gt;</span><br><span class="line">                    &lt;slot name=&quot;body&quot;&gt;&lt;/slot&gt;&lt;!-- slot用于内容分发 --&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">                &lt;div class=&quot;col-sm-3&quot;&gt;</span><br><span class="line">                    &lt;slot name=&quot;side&quot;&gt;&lt;/slot&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">        &lt;footer-component&gt;&lt;/footer-component&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import header from &apos;./header.vue&apos;</span><br><span class="line">import footer from &apos;./footer.vue&apos;</span><br><span class="line">import nav from &apos;./nav.vue&apos;</span><br><span class="line"></span><br><span class="line">export default &#123;</span><br><span class="line">    components: &#123;</span><br><span class="line">        &apos;header-component&apos;: header,</span><br><span class="line">        &apos;footer-component&apos;: footer,</span><br><span class="line">        &apos;nav-component&apos;: nav,</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">.layout &#123;</span><br><span class="line">    background: #f5f5f5;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>
<p>在 <code>layout</code> 里还使用 <code>header</code>,<code>footer</code>,<code>nav</code> 三个组件，分别在 <code>components</code> 目录下创建 <code>header.vue</code>,<code>footer.vue</code>,<code>nav.vue</code>组件<br>header.vue:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;div class=&quot;container&quot;&gt;</span><br><span class="line">        &lt;div class=&quot;row&quot;&gt;</span><br><span class="line">            &lt;div class=&quot;col-sm-3&quot;&gt;</span><br><span class="line">                &lt;div class=&quot;logo&quot;&gt;什么值得买&lt;/div&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">            &lt;div class=&quot;col-sm-6 search&quot;&gt;</span><br><span class="line">                &lt;div class=&quot;input-group&quot;&gt;</span><br><span class="line">                    &lt;input type=&quot;text&quot; class=&quot;form-control&quot;&gt;</span><br><span class="line">                    &lt;span class=&quot;input-group-btn&quot;&gt;</span><br><span class="line">                        &lt;button class=&quot;btn btn-default&quot; type=&quot;button&quot;&gt;</span><br><span class="line">                            &lt;i class=&quot;fa fa-search&quot; aria-hidden=&quot;true&quot;&gt;&lt;/i&gt;</span><br><span class="line">                        &lt;/button&gt;</span><br><span class="line">                    &lt;/span&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">                &lt;div class=&quot;hot-search&quot;&gt;</span><br><span class="line">                    &lt;span&gt;热门搜索：&lt;/span&gt;</span><br><span class="line">                    &lt;span&gt;零食&lt;/span&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">//...</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>
<p>footer.vue<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;footer&gt;</span><br><span class="line">        &lt;div class=&quot;container&quot;&gt;</span><br><span class="line">            page footer</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">    &lt;/footer&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">footer &#123;</span><br><span class="line">    padding: 50px 0;</span><br><span class="line">    font-size: 14px;</span><br><span class="line">    color: #ccc;</span><br><span class="line">    background: #333;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure></p>
<p>nav.vue</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;nav&gt;</span><br><span class="line">        &lt;div class=&quot;container&quot;&gt;</span><br><span class="line">            &lt;router-link to=&quot;/&quot; exact&gt;首页&lt;/router-link&gt;</span><br><span class="line">            &lt;div class=&quot;pull-right&quot;&gt;</span><br><span class="line">                &lt;a href=&quot;#&quot;&gt;登录&lt;/a&gt;</span><br><span class="line">                &lt;a href=&quot;#&quot;&gt;注册&lt;/a&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">    &lt;/nav&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">// ...</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>
<h1 id="编译运行"><a href="#编译运行" class="headerlink" title="编译运行"></a>编译运行</h1><p>使用命令</p>
<ul>
<li><code>npm run build</code></li>
<li><code>npm start</code></li>
</ul>
<p>运行结果:<br><img src="https://note.youdao.com/yws/public/resource/1846205add14351700747a3032894a3c/xmlnote/8205CE0030384045A95F1E9718508A1F/10050" alt="运行结果"></p>
<p>目录结构:</p>
<p><img src="https://note.youdao.com/yws/public/resource/1846205add14351700747a3032894a3c/xmlnote/7AE06563AC9644ACADA55FEBED74913A/10051" alt="目录结构"></p>

                


<p class="pink-link-context">
    <a href="/2018/06/30/hello-world/" rel="next" title="Hello World">
    下一篇：Hello World
  </a>
</p>


            </div>
			
        </div>
    </div>
</article>






</div>

        <div class="fixed-action-btn float-sitemap">
    <a class="btn-floating btn-large pink">
      <i class="fa fa-caret-square-o-up"></i>
    </a>
    <ul>
      <li><a class="btn-return-top btn-floating waves-effect green" title="回到顶部"><i class="fa fa-arrow-circle-o-up"></i></a></li>
      <li><a class="btn-floating waves-effect button-collapse yellow darken-1"  data-activates="main-menu" title="菜单"><i class="fa fa-navicon"></i></a></li>
    </ul>
  </div>

    </main>
    <footer class="page-footer indigo darken-1">
    

    <div class="footer-copyright pink-link-context">
        <div class="container">
            © 2016 example.com, All rights reserved.
            <p class="right" style="margin-top: 0;">本博客由 <a href="https://hexo.io">Hexo</a> 强力驱动 | 主题 <a href="https://github.com/raytaylorlin/hexo-theme-raytaylorism">raytaylorism</a></p>
        </div>
    </div>
</footer>


    <noscript>
    <div class="noscript">
        <p class="center-align">当前网速较慢或者你使用的浏览器不支持博客特定功能，请尝试刷新或换用Chrome、Firefox等现代浏览器</p>
    </div>
</noscript>
<div class="noscript">
    <p class="center-align">当前网速较慢或者你使用的浏览器不支持博客特定功能，请尝试刷新或换用Chrome、Firefox等现代浏览器</p>
</div>


<script src="/js/jquery.min.js"></script>
<script src="/js/materialize.min.js"></script>

<script>
    (function($) {
        $(document).ready(function() {
            // 隐藏禁用javascript（针对微信内置浏览器）的提示
            $('.noscript').hide();

            // 图片缩放效果
            var $imgs = $('img').not('.slider-image').not('.avatar-image').not('.carousel-image').not('.card-cover-image').not('.qrcode');

            // 给图片加上点击放大效果（materialbox插件）
            $imgs.addClass('materialboxed').each(function(i, el) {
                $(this).attr('data-caption', $(this).attr('alt') || ' ');
            }).materialbox();

            // 优化表格的显示
            $('table').each(function() {
                var $table = $(this);
                // 除去多行代码的情况
                if ($table.find('pre').length == 0) {
                    $table.addClass('responsive-table striped bordered');
                }
            });

            // 首页幻灯片
            $('.slider').slider({indicators: true, full_width: true, interval: 8000});

            $(".button-collapse").sideNav();
            $(".category-menu").sideNav();

            // 针对gallery post
            $('.carousel').carousel({full_width: true});
            $('.carousel-control.prev').click(function() {
                $('.carousel').carousel('prev');
            });
            $('.carousel-control.next').click(function() {
                $('.carousel').carousel('next');
            });

            // 文章目录
            $('article').not('.simple-article').find('h1').add('h2').add('h3').add('h4').add('h5').add('h6').scrollSpy();

            // 目录随屏幕滚动（防止目录过长越过footer）
            var $toc = $('.toc');
            var scrollTargetTop = 0;
            $(window).scroll(function() {
                var $activeLink = $toc.find('a.active.section');
                if ($(window).scrollTop() < 100) {
                    scrollTargetTop = 0;
                } else {
                    if ($activeLink[0]) {
                        scrollTargetTop = $activeLink.offset().top - $toc.offset().top;
                    }
                }
                $toc.css('top', '-' + scrollTargetTop + 'px');
            });

            // 修正文章目录的left-border颜色
            var color = $('.table-of-contents-text').css('color');
            $('.table-of-contents-link').css('border-left-color', color);

            // 针对移动端做的优化：FAB按钮点击一下收回
            if (/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)) {
                $('.fixed-action-btn').addClass('click-to-toggle');
            }
            // 回到顶部
            $('.btn-return-top').click(function() {
                $('body, html').animate({
                    scrollTop: 0
                }, 500);
            });

            // 重置读书页面的Tab标签页的颜色
            $('li.tab a').hover(function() {
                $(this).toggleClass('text-lighten-4');
            });
            $('.indicator').addClass('pink lighten-2');

            

            // 搜索功能
            $('.modal-trigger').leanModal({
                // 打开搜索框时自动聚焦
                ready: function() {
                    if ($('#search').is(":visible")) {
                        $('#search-input').focus();
                    }
                }
            });
            var searchXml = "";
            if (searchXml.length == 0) {
             	searchXml = "search.xml";
            }
            var searchPath = "/" + searchXml;
            initSearch(searchPath, 'search-input', 'search-result');
        });

        // 初始化搜索与匹配函数
        var initSearch = function(path, search_id, content_id) {
            'use strict';
            $.ajax({
                url: path,
                dataType: "xml",
                success: function(xmlResponse) {
                    // get the contents from search data
                    var datas = $("entry", xmlResponse).map(function() {
                        return {
                            title: $("title", this).text(),
                            content: $("content", this).text(),
                            url: $("url", this).text()
                        };
                    }).get();
                    var $input = document.getElementById(search_id);
                    var $resultContent = document.getElementById(content_id);
                    $input.addEventListener('input', function() {
                        var str = '<ul class=\"search-result-list\">';
                        var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                        $resultContent.innerHTML = "";
                        if (this.value.trim().length <= 0) {
                            return;
                        }
                        // perform local searching
                        datas.forEach(function(data) {
                            var isMatch = true;
                            var content_index = [];
                            var data_title = data.title.trim().toLowerCase();
                            var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                            var data_url = data.url;
                            var index_title = -1;
                            var index_content = -1;
                            var first_occur = -1;
                            // only match artiles with not empty titles and contents
                            if (data_title != '' && data_content != '') {
                                keywords.forEach(function(keyword, i) {
                                    index_title = data_title.indexOf(keyword);
                                    index_content = data_content.indexOf(keyword);
                                    if (index_title < 0 && index_content < 0) {
                                        isMatch = false;
                                    } else {
                                        if (index_content < 0) {
                                            index_content = 0;
                                        }
                                        if (i == 0) {
                                            first_occur = index_content;
                                        }
                                    }
                                });
                            }
                            // show search results
                            if (isMatch) {
                                keywords.forEach(function(keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    data_title = data_title.replace(regS, "<span class=\"search-keyword pink lighten-2\">" + keyword + "</span>");
                                });

                                str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                                var content = data.content.trim().replace(/<[^>]+>/g, "");
                                if (first_occur >= 0) {
                                    // cut out 100 characters
                                    var start = first_occur - 20;
                                    var end = first_occur + 80;
                                    if (start < 0) {
                                        start = 0;
                                    }
                                    if (start == 0) {
                                        end = 100;
                                    }
                                    if (end > content.length) {
                                        end = content.length;
                                    }
                                    var match_content = content.substring(start, end);
                                    // highlight all keywords
                                    keywords.forEach(function(keyword) {
                                        var regS = new RegExp(keyword, "gi");
                                        match_content = match_content.replace(regS, "<span class=\"search-keyword pink lighten-2\">" + keyword + "</span>");
                                    });

                                    str += "<p class=\"search-result\">..." + match_content + "...</p>"
                                }
                                str += "</li>";
                            }
                        });
                        str += "</ul>";
                        $resultContent.innerHTML = str;
                    });
                }
            });
        }
    })(jQuery);
</script>


<script src="/js/prettify.js"></script>
<script type="text/javascript">
    $(document).ready(function() {
        $("pre").addClass("prettyprint");
        prettyPrint();
    });
</script>






<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
});
</script>
<script type="text/javascript" async
  src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
</script>



</body>
</html>
